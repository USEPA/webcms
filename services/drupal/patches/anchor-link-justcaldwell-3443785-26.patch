diff --git a/anchor_link.libraries.yml b/anchor_link.libraries.yml
index 9e02a91..c9bfcef 100644
--- a/anchor_link.libraries.yml
+++ b/anchor_link.libraries.yml
@@ -8,7 +8,7 @@ drupal.anchor_link:
     - core/drupalSettings
 cke5_anchor_link:
   js:
-    /libraries/ckeditor5-anchor-drupal/build/anchor-drupal.js: { preprocess: false, minified: true }
+    js/anchor-drupal.js: { preprocess: false, minified: true }
   dependencies:
     - core/ckeditor5
 admin.cke5_anchor_link:
diff --git a/js/anchor-drupal.js b/js/anchor-drupal.js
new file mode 100644
index 0000000..131feeb
--- /dev/null
+++ b/js/anchor-drupal.js
@@ -0,0 +1,63 @@
+!function(e){const t=e.en=e.en||{};t.dictionary=Object.assign(t.dictionary||{},{Anchor:"Anchor","Anchor name":"Anchor name","Edit anchor":"Edit anchor",Unanchor:"Unanchor"})}(window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={})),(()=>{var e={54:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(314),o=n.n(i)()(function(e){return e[1]});o.push([e.id,"",""]);const r=o},72:(e,t,n)=>{"use strict";var i,o=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},r=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),s=[];function a(e){for(var t=-1,n=0;n<s.length;n++)if(s[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},i=[],o=0;o<e.length;o++){var r=e[o],c=t.base?r[0]+t.base:r[0],l=n[c]||0,d="".concat(c," ").concat(l);n[c]=l+1;var h=a(d),u={css:r[1],media:r[2],sourceMap:r[3]};-1!==h?(s[h].references++,s[h].updater(u)):s.push({identifier:d,updater:b(u,t),references:1}),i.push(d)}return i}function l(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var o=n.nc;o&&(i.nonce=o)}if(Object.keys(i).forEach(function(e){t.setAttribute(e,i[e])}),"function"==typeof e.insert)e.insert(t);else{var s=r(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var d,h=(d=[],function(e,t){return d[e]=t,d.filter(Boolean).join("\n")});function u(e,t,n,i){var o=n?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=h(t,o);else{var r=document.createTextNode(o),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(r,s[t]):e.appendChild(r)}}function m(e,t,n){var i=n.css,o=n.media,r=n.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var f=null,g=0;function b(e,t){var n,i,o;if(t.singleton){var r=g++;n=f||(f=l(t)),i=u.bind(null,n,r,!1),o=u.bind(null,n,r,!0)}else n=l(t),i=m.bind(null,n,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=o());var n=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<n.length;i++){var o=a(n[i]);s[o].references--}for(var r=c(e,t),l=0;l<n.length;l++){var d=a(n[l]);0===s[d].references&&(s[d].updater(),s.splice(d,1))}n=r}}}},160:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(314),o=n.n(i)()(function(e){return e[1]});o.push([e.id,".ck.ck-anchor-form{display:flex}.ck.ck-anchor-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-anchor-form{flex-wrap:wrap}.ck.ck-anchor-form .ck-labeled-field-view{flex-basis:100%}.ck.ck-anchor-form .ck-button{flex-basis:50%}}.ck.ck-anchor-form_layout-vertical{display:block}.ck.ck-anchor-form_layout-vertical .ck-button.ck-button-cancel,.ck.ck-anchor-form_layout-vertical .ck-button.ck-button-save{margin-top:var(--ck-spacing-medium)}",""]);const r=o},205:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(314),o=n.n(i)()(function(e){return e[1]});o.push([e.id,'.ck.ck-anchor-actions{display:flex;flex-direction:row;flex-wrap:nowrap}.ck.ck-anchor-actions .ck-anchor-actions__preview{display:inline-block}.ck.ck-anchor-actions .ck-anchor-actions__preview .ck-button__label{overflow:hidden}@media screen and (max-width:600px){.ck.ck-anchor-actions{flex-wrap:wrap}.ck.ck-anchor-actions .ck-anchor-actions__preview{flex-basis:100%}.ck.ck-anchor-actions .ck-button:not(.ck-anchor-actions__preview){flex-basis:50%}}div[contenteditable=false] .ck-anchor{background-size:16px;color:#00f;cursor:auto;padding-left:18px}div[contenteditable=true] .ck-anchor{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAAB3RJTUUH4AsCDSEAgw7OCAAAA1lJREFUWMPdl82LHEUYxn/VPTthe5Q1SMgt7GlZRG8KXrwEsgQlmEvwkIsL2YPgvyAEIoFcAvG0Nw8hgroQiHtIRNBLIAhqAlmQfHkIHiQssjg7n131eOjqmeqPnWF24x58oJjp6n7f99dVXdVPI4mpzTmctbg0LTRZi5ybHl9snykTkiicdM5hrcVai8sTW4vt95H0tqTvJP0pyaqotRFMHdC4/9MgpgJQq3+2tvY8F+impCNuMCiOjHPIWtxwiKSPSjFjAH+3k+WcHqyu6vujR/XD8eP65exZ7dy7V77qhaT3bLeLGw5xwyFpu42kz2vyjQGstSMAQFDkeXzxom6AvgZt+PYN6Ib//+zKlTrk3yX9Fnb8uLg4rp/VxOQAcRwLIEkSBHQ7HQDunzvH1sYGCdAAIjIJcIAFBr7vjdVV3lpfh2aTUP3nz/lpeZlnnQ6fSFm8tcbEcRVgYWEBgJ2dHQC+NIbXgLmgeKgQJPUw88DrS0tEzSbbDx/SAWKgA3ycA6SpMXFMo5zQGIOC44YPrisOYILzDeCIB9p+9Ah8/yu+r18T36hLKueYVca3vGjdSNWpAuCcI4rGKQyza5aYCmwURThphhQHUwVAh1i8FuCwVQFw+3gA/18jEEXRvpbhSwM47Cmo7AOSMME+oOC3vD7CzeelAdTJMd7vre+LyLbgfBueBKPS71SAcBpSoEu2xy+vrXHszBnM3Bx/373LH1evst3p0GT8ssphwuLyedLC8BkwpgoQRRE2AOgCb66s8M6dO4Xrjp0+zdKlS7h2m1/Pn+fJrVtEHiQOIJwv3ANOXrtWBIBsztM0HTmQVqulpNUaGYefT50KPcV9SR/4tl52IE8uX9ZN0HXQV75dB22Cdp8+DS9dKTiiCkCS1DmcD22/P3bFwyG220XSu96KjWR7Pb24fVt/bW7K7u6W85xwacqsACdHQWHzVt0OBkh6VdK3E1zlF2m7TVi8FiBJEs3Pz4eBF/a024Hldt792l4vn9r3/VQt2l5vz++IiiVrtVoYY2i32/mKMKE/mKjsjrLllr9VjcHkD5ypLtR6RxS8kmd6PfuldSBDkn8RHZYqI5Cm6dQgEwzlfmHzHI1ywjKAKc3btON9jcCkOzpogWmKphX5rwH+BWxcUbVSlumsAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE2LTExLTAyVDEzOjMzOjAwKzAxOjAw1wGs7QAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNi0xMS0wMlQxMzozMzowMCswMTowMKZcFFEAAAAASUVORK5CYII=") no-repeat 0;background-size:16px;color:#00f;cursor:auto;padding-left:18px}',""]);const r=o},237:e=>{"use strict";e.exports=CKEditor5.dll},311:(e,t,n)=>{e.exports=n(237)("./src/ui.js")},314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n}).join("")},t.i=function(e,n,i){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(i)for(var r=0;r<this.length;r++){var s=this[r][0];null!=s&&(o[s]=!0)}for(var a=0;a<e.length;a++){var c=[].concat(e[a]);i&&o[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},331:(e,t,n)=>{e.exports=n(237)("./src/clipboard.js")},584:(e,t,n)=>{e.exports=n(237)("./src/utils.js")},782:(e,t,n)=>{e.exports=n(237)("./src/core.js")},783:(e,t,n)=>{e.exports=n(237)("./src/engine.js")},834:(e,t,n)=>{e.exports=n(237)("./src/typing.js")},871:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var i=n(314),o=n.n(i)()(function(e){return e[1]});o.push([e.id,'.ck-vertical-form .ck-button:after{bottom:-1px;content:"";position:absolute;right:-1px;top:-1px;width:0;z-index:1}.ck-vertical-form .ck-button:focus:after{display:none}@media screen and (max-width:600px){.ck.ck-responsive-form .ck-button:after{bottom:-1px;content:"";position:absolute;right:-1px;top:-1px;width:0;z-index:1}.ck.ck-responsive-form .ck-button:focus:after{display:none}}.ck-vertical-form>.ck-button:nth-last-child(2):after{border-right:1px solid var(--ck-color-base-border)}.ck.ck-responsive-form{padding:var(--ck-spacing-large)}.ck.ck-responsive-form:focus{outline:none}.ck.ck-responsive-form{[dir=ltr] &>:not(:first-child),[dir=rtl] &>:not(:last-child){margin-left:var(--ck-spacing-standard)}}@media screen and (max-width:600px){.ck.ck-responsive-form{padding:0;width:calc(var(--ck-input-width)*.8)}.ck.ck-responsive-form .ck-labeled-field-view{margin:var(--ck-spacing-large) var(--ck-spacing-large) 0}.ck.ck-responsive-form .ck-labeled-field-view .ck-input-number,.ck.ck-responsive-form .ck-labeled-field-view .ck-input-text{min-width:0;width:100%}.ck.ck-responsive-form .ck-labeled-field-view .ck-labeled-field-view__error{white-space:normal}.ck.ck-responsive-form>.ck-button:nth-last-child(2):after{border-right:1px solid var(--ck-color-base-border)}.ck.ck-responsive-form>.ck-button:last-child,.ck.ck-responsive-form>.ck-button:nth-last-child(2){border-radius:0;margin-top:var(--ck-spacing-large);padding:var(--ck-spacing-standard)}.ck.ck-responsive-form>.ck-button:last-child:not(:focus),.ck.ck-responsive-form>.ck-button:nth-last-child(2):not(:focus){border-top:1px solid var(--ck-color-base-border)}.ck.ck-responsive-form>.ck-button:last-child,.ck.ck-responsive-form>.ck-button:nth-last-child(2){[dir=ltr] &,[dir=rtl] &{margin-left:0}[dir=rtl] &:last-of-type{border-right:1px solid var(--ck-color-base-border)}}}',""]);const r=o},901:(e,t,n)=>{e.exports=n(237)("./src/widget.js")}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={id:i,exports:{}};return e[i](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0;var i={};(()=>{"use strict";n.r(i),n.d(i,{Anchor:()=>q});var e=n(782),t=n(783),o=n(834),r=n(331),s=n(584);
+/**
+ * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.
+ * For licensing, see LICENSE.md.
+ */
+class a{constructor(){this._definitions=new Set}get length(){return this._definitions.size}add(e){Array.isArray(e)?e.forEach(e=>this._definitions.add(e)):this._definitions.add(e)}getDispatcher(){return e=>{e.on("attribute:anchorId",(e,t,n)=>{if(!n.consumable.test(t.item,"attribute:anchorId"))return;const i=n.writer,o=i.document.selection;for(const e of this._definitions){const r=i.createAttributeElement("a",e.attributes,{priority:5});i.setCustomProperty("anchor",!0,r),e.callback(t.attributeNewValue)?t.item.is("selection")?i.wrap(o.getFirstRange(),r):i.wrap(n.mapper.toViewRange(t.range),r):i.unwrap(n.mapper.toViewRange(t.range),r)}},{priority:"high"})}}getDispatcherForAnchoredImage(){return e=>{e.on("attribute:anchorId:image",(e,t,n)=>{const i=n.mapper.toViewElement(t.item),o=Array.from(i.getChildren()).find(e=>"a"===e.name);for(const e of this._definitions){const i=(0,s.toMap)(e.attributes);if(e.callback(t.attributeNewValue))for(const[e,t]of i)"class"===e?n.writer.addClass(t,o):n.writer.setAttribute(e,t,o);else for(const[e,t]of i)"class"===e?n.writer.removeClass(t,o):n.writer.removeAttribute(e,o)}})}}}function c(e){return e.substring(0,1).toUpperCase()+e.substring(1)}var l=n(901);
+/**
+ * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.
+ * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
+ */
+const d=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,h=/^(?:(?:https?|ftps?|mailto):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))/i,u=/^[\S]+@((?![-_])(?:[-\w\u00a1-\uffff]{0,63}[^-_]\.))+(?:[a-z\u00a1-\uffff]{2,})$/i,m=/^((\w+:(\/{2,})?)|(\W))/i,f="Ctrl+M";function g(e,{writer:t}){const n=t.createAttributeElement("a",{id:e},{priority:5});return t.addClass("ck-anchor",n),t.setCustomProperty("anchor",!0,n),n}function b(e){return function(e){const t=e.replace(d,"");return t.match(h)}(e=String(e))?e:"#"}function w(e,t){return!!e&&(e.is("element","image")&&t.checkAttribute("image","anchorId"))}function p(e,t){const n=(i=e,u.test(i)?"mailto:":t);var i;const o=!!n&&!m.test(e);return e&&o?n+e:e}
+/**
+ * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.
+ * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
+ */
+class v extends e.Command{constructor(e){super(e),this.manualDecorators=new s.Collection,this.automaticDecorators=new a}restoreManualDecoratorStates(){for(const e of this.manualDecorators)e.value=this._getDecoratorStateFromModel(e.id)}refresh(){const e=this.editor.model,t=e.document,n=(0,s.first)(t.selection.getSelectedBlocks());w(n,e.schema)?(this.value=n.getAttribute("anchorId"),this.isEnabled=e.schema.checkAttribute(n,"anchorId")):(this.value=t.selection.getAttribute("anchorId"),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"anchorId"));for(const e of this.manualDecorators)e.value=this._getDecoratorStateFromModel(e.id)}execute(e,t={}){const n=this.editor.model,i=n.document.selection,r=[],a=[];for(const e in t)t[e]?r.push(e):a.push(e);n.change(t=>{if(i.isCollapsed){const c=i.getFirstPosition();if(i.hasAttribute("anchorId")){const s=(0,o.findAttributeRange)(c,"anchorId",i.getAttribute("anchorId"),n);t.setAttribute("anchorId",e,s),r.forEach(e=>{t.setAttribute(e,!0,s)}),a.forEach(e=>{t.removeAttribute(e,s)}),t.setSelection(t.createPositionAfter(s.end.nodeBefore))}else if(""!==e){const o=(0,s.toMap)(i.getAttributes());o.set("anchorId",e),r.forEach(e=>{o.set(e,!0)});const{end:a}=n.insertContent(t.createElement("anchor",o),c);t.setSelection(a)}["anchorId",...r,...a].forEach(e=>{t.removeSelectionAttribute(e)})}else if("anchor"===i.getSelectedElement()?.name){const i=t.createElement("anchor",{anchorId:e});n.insertObject(i,null,null,{setSelection:"on"})}else{const o=n.schema.getValidRanges(i.getRanges(),"anchorId"),s=[];for(const e of i.getSelectedBlocks())n.schema.checkAttribute(e,"anchorId")&&s.push(t.createRangeOn(e));const c=s.slice();for(const e of o)this._isRangeToUpdate(e,s)&&c.push(e);for(const n of c)t.setAttribute("anchorId",e,n),r.forEach(e=>{t.setAttribute(e,!0,n)}),a.forEach(e=>{t.removeAttribute(e,n)})}})}_getDecoratorStateFromModel(e){const t=this.editor.model,n=t.document,i=(0,s.first)(n.selection.getSelectedBlocks());return w(i,t.schema)?i.getAttribute(e):n.selection.getAttribute(e)}_isRangeToUpdate(e,t){for(const n of t)if(n.containsRange(e))return!1;return!0}}
+/**
+ * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.
+ * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
+ */
+class k extends e.Command{refresh(){const e=this.editor.model,t=e.document,n=(0,s.first)(t.selection.getSelectedBlocks());w(n,e.schema)?this.isEnabled=e.schema.checkAttribute(n,"anchorId"):this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"anchorId")}execute(){const e=this.editor,t=this.editor.model,n=t.document.selection,i=e.commands.get("anchor");t.change(e=>{const r=n.isCollapsed?[(0,o.findAttributeRange)(n.getFirstPosition(),"anchorId",n.getAttribute("anchorId"),t)]:t.schema.getValidRanges(n.getRanges(),"anchorId");for(const t of r)if(e.removeAttribute("anchorId",t),i)for(const n of i.manualDecorators)e.removeAttribute(n.id,t);"anchor"===n.getSelectedElement()?.name&&t.deleteContent(n)})}}
+/**
+ * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.
+ * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
+ */
+class A extends((0,s.ObservableMixin)()){constructor({id:e,label:t,attributes:n,defaultValue:i}){this.id=e,this.set("value"),this.defaultValue=i,this.label=t,this.attributes=n}}
+/**
+ * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
+ * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
+ */
+function _(e,t,n,i){return i.createRange(V(e,t,n,!0,i),V(e,t,n,!1,i))}function V(e,t,n,i,o){let r=e.textNode||(i?e.nodeBefore:e.nodeAfter),s=null;for(;r&&r.getAttribute(t)==n;)s=r,r=i?r.previousSibling:r.nextSibling;return s?o.createPositionAt(s,i?"before":"after"):e}Error;
+/**
+ * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
+ * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
+ */
+let I;try{I={window,document}}catch{
+/* istanbul ignore next -- @preserve */
+I={window:{},document:{}}}
+/**
+ * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
+ * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
+ */
+const T=y();function y(){const e={pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,shift:2228224,alt:4456448,cmd:8912896};for(let t=65;t<=90;t++){e[String.fromCharCode(t).toLowerCase()]=t}for(let t=48;t<=57;t++)e[t-48]=t;for(let t=112;t<=123;t++)e["f"+(t-111)]=t;return Object.assign(e,{"'":222,",":108,"-":109,".":110,"/":111,";":186,"=":187,"[":219,"\\":220,"]":221,"`":223}),e}var x=n(72),C=n.n(x),E=n(54),S={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};C()(E.A,S);E.A.locals;const B="automatic",D=/^(https?:)?\/\//;class F extends e.Plugin{static get pluginName(){return"AnchorEditing"}static get requires(){return[o.TwoStepCaretMovement,o.Input,r.Clipboard]}constructor(e){super(e),e.config.define("anchor",{addTargetToExternalAnchors:!1})}init(){const e=this.editor;e.model.schema.extend("$text",{allowAttributes:"anchorId"}),e.model.schema.register("anchor",{allowContentOf:"$inlineObject",allowWhere:"$inlineObject",inheritTypesFrom:"$inlineObject",allowAttributes:["class","id","anchorId","name"]}),e.conversion.for("dataDowncast").attributeToElement({model:{name:"$text",key:"anchorId"},view:g}),e.conversion.for("dataDowncast").elementToElement({model:"anchor",view:(e,t)=>function(e,{writer:t}){let n=null;return n=t.createEmptyElement("a",{id:e}),t.addClass("ck-anchor",n),t.setCustomProperty("anchor",!0,n),n}(e.getAttribute("anchorId"),t)}),e.conversion.for("editingDowncast").attributeToElement({model:"anchorId",view:(e,t)=>e?g(b(e),t):null}),e.conversion.for("editingDowncast").elementToElement({model:"anchor",view:(e,t)=>function(e,{writer:t}){const n=t.createContainerElement("span",{class:"ck-anchor-placeholder"},[t.createText(`[INVISIBLE ANCHOR: ${e}]`)]);return(0,l.toWidget)(n,t)}(e.getAttribute("anchorId"),t)}),e.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:{id:!0}},model:{key:"anchorId",value:e=>{if(!(e.childCount<1))return e.getAttribute("id")}}}),e.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:{name:!0}},model:{key:"anchorId",value:e=>{if(!(e.childCount<1))return e.getAttribute("name")}}}),e.conversion.for("upcast").elementToElement({view:{name:"a",attributes:{id:!0}},model:(e,{writer:t})=>{if(!(e.childCount>0))return t.createElement("anchor",{anchorId:e.getAttribute("id")})}}),e.conversion.for("upcast").elementToElement({view:{name:"a",attributes:{name:!0}},model:(e,{writer:t})=>{if(!(e.childCount>0))return t.createElement("anchor",{anchorId:e.getAttribute("name")})}}),e.commands.add("anchor",new v(e)),e.commands.add("unanchor",new k(e));const t=function(e,t){const n={};return t.forEach(e=>(e.label&&n[e.label]&&(e.label=n[e.label]),e)),t}(e.t,function(e){const t=[];if(e)for(const[n,i]of Object.entries(e)){const e=Object.assign({},i,{id:`anchor${c(n)}`});t.push(e)}return t}(e.config.get("anchor.decorators")));this._enableAutomaticDecorators(t.filter(e=>e.mode===B)),this._enableManualDecorators(t.filter(e=>"manual"===e.mode));e.plugins.get(o.TwoStepCaretMovement).registerAttribute("anchorId"),(0,o.inlineHighlight)(e,"anchorId","a","ck-anchor_selected"),this._enableInsertContentSelectionAttributesFixer(),this._enableClickingAfterAnchor(),this._enableTypingOverAnchor(),this._handleDeleteContentAfterAnchor(),e.editing.mapper.on("viewToModelPosition",(0,l.viewToModelPositionOutsideModelElement)(e.model,e=>e.hasClass("ck-anchor-placeholder")))}_enableAutomaticDecorators(e){const t=this.editor,n=t.commands.get("anchor").automaticDecorators;t.config.get("anchor.addTargetToExternalAnchors")&&n.add({id:"anchorIsExternal",mode:B,callback:e=>D.test(e),attributes:{target:"_blank",rel:"noopener noreferrer"}}),n.add(e),n.length&&t.conversion.for("downcast").add(n.getDispatcher())}_enableManualDecorators(e){if(!e.length)return;const t=this.editor,n=t.commands.get("anchor").manualDecorators;e.forEach(e=>{t.model.schema.extend("$text",{allowAttributes:e.id}),n.add(new A(e)),t.conversion.for("downcast").attributeToElement({model:e.id,view:(t,{writer:i})=>{if(t){const t=n.get(e.id).attributes,o=i.createAttributeElement("a",t,{priority:5});return i.setCustomProperty("anchor",!0,o),o}}}),t.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:n.get(e.id).attributes},model:{key:e.id}})})}_enableInsertContentSelectionAttributesFixer(){const e=this.editor,t=e.model,n=t.document.selection,i=e.commands.get("anchor");this.listenTo(t,"insertContent",()=>{const e=n.anchor.nodeBefore,o=n.anchor.nodeAfter;n.hasAttribute("anchorId")&&e&&e.hasAttribute("anchorId")&&(o&&o.hasAttribute("anchorId")||t.change(e=>{P(e,i.manualDecorators)}))},{priority:"low"})}_enableClickingAfterAnchor(){const e=this.editor,n=e.commands.get("anchor");e.editing.view.addObserver(t.MouseObserver);let i=!1;this.listenTo(e.editing.view.document,"mousedown",()=>{i=!0}),this.listenTo(e.editing.view.document,"selectionChange",()=>{if(!i)return;i=!1;const t=e.model.document.selection;if(!t.isCollapsed)return;if(!t.hasAttribute("anchorId"))return;const o=t.getFirstPosition(),r=_(o,"anchorId",t.getAttribute("anchorId"),e.model);(o.isTouching(r.start)||o.isTouching(r.end))&&e.model.change(e=>{P(e,n.manualDecorators)})})}_enableTypingOverAnchor(){const e=this.editor,t=e.editing.view;let n,i;this.listenTo(t.document,"delete",()=>{i=!0},{priority:"high"}),this.listenTo(e.model,"deleteContent",()=>{const t=e.model.document.selection;t.isCollapsed||(i?i=!1:M(e)&&function(e){const t=e.document.selection,n=t.getFirstPosition(),i=t.getLastPosition(),o=n.nodeAfter;if(!o)return!1;if(!o.is("$text"))return!1;if(!o.hasAttribute("anchorId"))return!1;const r=i.textNode||i.nodeBefore;if(o===r)return!0;return _(n,"anchorId",o.getAttribute("anchorId"),e).containsRange(e.createRange(n,i),!0)}(e.model)&&(n=t.getAttributes()))},{priority:"high"}),this.listenTo(e.model,"insertContent",(t,[o])=>{i=!1,M(e)&&n&&(e.model.change(e=>{for(const[t,i]of n)e.setAttribute(t,i,o)}),n=null)},{priority:"high"})}_handleDeleteContentAfterAnchor(){const e=this.editor,t=e.model,n=t.document.selection,i=e.editing.view,o=e.commands.get("anchor");let r=!1,s=!1;this.listenTo(i.document,"delete",(e,t)=>{s=t.domEvent.keyCode===T.backspace},{priority:"high"}),this.listenTo(t,"deleteContent",()=>{r=!1;const e=n.getFirstPosition(),i=n.getAttribute("anchorId");if(!i)return;const o=_(e,"anchorId",i,t);r=o.containsPosition(e)||o.end.isEqual(e)},{priority:"high"}),this.listenTo(t,"deleteContent",()=>{s&&(s=!1,r||e.model.enqueueChange(e=>{P(e,o.manualDecorators)}))},{priority:"low"})}}function P(e,t){e.removeSelectionAttribute("anchorId");for(const n of t)e.removeSelectionAttribute(n.id)}function M(e){return e.model.change(e=>e.batch).isTyping}var O=n(311);var R=n(160),j={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};C()(R.A,j);R.A.locals;var z=n(871),U={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};C()(z.A,U);z.A.locals;
+/**
+ * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.
+ * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
+ */
+class L extends(
+/**
+ * @license Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
+ * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-licensing-options
+ */
+function(e){return class extends e{disableCssTransitions(){this._isCssTransitionsDisabled=!0}enableCssTransitions(){this._isCssTransitionsDisabled=!1}constructor(...e){super(...e),this.set("_isCssTransitionsDisabled",!1),this.initializeCssTransitionDisablerMixin()}initializeCssTransitionDisablerMixin(){this.template&&this.extendTemplate({attributes:{class:[this.bindTemplate.if("_isCssTransitionsDisabled","ck-transitions-disabled")]}})}}}(O.View)){constructor(e,t){super(e);const n=e.t;this.focusTracker=new s.FocusTracker,this.keystrokes=new s.KeystrokeHandler,this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(n("Save"),'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M6.972 16.615a1 1 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a1 1 0 0 1-.745.292"/></svg>',"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(n("Cancel"),'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414z"/></svg>',"ck-button-cancel","cancel"),this._manualDecoratorSwitches=this._createManualDecoratorSwitches(t),this.children=this._createFormChildren(t.manualDecorators),this._focusables=new O.ViewCollection,this._focusCycler=new O.FocusCycler({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});const i=["ck","ck-anchor-form","ck-responsive-form"];t.manualDecorators.length&&i.push("ck-anchor-form_layout-vertical","ck-vertical-form"),this.setTemplate({tag:"form",attributes:{class:i,tabindex:"-1"},children:this.children})}getDecoratorSwitchesState(){return Array.from(this._manualDecoratorSwitches).reduce((e,t)=>(e[t.name]=t.isOn,e),{})}render(){super.render(),(0,O.submitHandler)({view:this});[this.urlInputView,...this._manualDecoratorSwitches,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}_createUrlInput(){const e=this.locale.t,t=new O.LabeledFieldView(this.locale,O.createLabeledInputText);return t.label=e("Anchor name"),t}_createButton(e,t,n,i){const o=new O.ButtonView(this.locale);return o.set({label:e,icon:t,tooltip:!0}),o.extendTemplate({attributes:{class:n}}),i&&o.delegate("execute").to(this,i),o}_createManualDecoratorSwitches(e){const t=this.createCollection();for(const n of e.manualDecorators){const i=new O.SwitchButtonView(this.locale);i.set({name:n.id,label:n.label,withText:!0}),i.bind("isOn").toMany([n,e],"value",(e,t)=>void 0===t&&void 0===e?n.defaultValue:e),i.on("execute",()=>{n.set("value",!i.isOn)}),t.add(i)}return t}_createFormChildren(e){const t=this.createCollection();if(t.add(this.urlInputView),e.length){const e=new O.View;e.setTemplate({tag:"ul",children:this._manualDecoratorSwitches.map(e=>({tag:"li",children:[e],attributes:{class:["ck","ck-list__item"]}})),attributes:{class:["ck","ck-reset","ck-list"]}}),t.add(e)}return t.add(this.saveButtonView),t.add(this.cancelButtonView),t}}var H=n(205),N={injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0};C()(H.A,N);H.A.locals;
+/**
+ * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.
+ * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
+ */
+class K extends O.View{constructor(e){super(e);const t=e.t;this.focusTracker=new s.FocusTracker,this.keystrokes=new s.KeystrokeHandler,this.unanchorButtonView=this._createButton(t("Unanchor"),'<?xml version="1.0" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20010904//EN"\n "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">\n<svg version="1.0"\n    xmlns="http://www.w3.org/2000/svg" width="512.000000pt" height="512.000000pt" viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet">\n    <metadata>\nCreated by potrace 1.16, written by Peter Selinger 2001-2019\n    </metadata>\n    <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="#000000" stroke="none">\n        <path d="M4255 5006 c-204 -208 -399 -316 -686 -380 -261 -58 -568 -60 -1104\n-7 -170 17 -404 36 -519 43 -593 32 -1000 -83 -1307 -370 l-72 -68 21 -64 c12\n-36 175 -616 363 -1290 188 -674 343 -1227 344 -1228 2 -2 44 31 94 75 201\n175 418 276 711 330 79 15 149 18 410 17 267 0 354 -4 575 -27 143 -15 318\n-32 390 -37 192 -16 529 -14 666 4 349 47 616 174 843 400 95 95 124 139 132\n198 11 83 7 88 -133 163 -250 133 -497 302 -731 501 -62 53 -115 106 -118 119\n-3 12 17 114 45 226 97 396 173 780 227 1157 19 134 34 268 32 296 -3 51 -3\n51 -38 53 -32 1 -44 -7 -145 -111z"/>\n        <path d="M152 4245 c-97 -30 -151 -104 -152 -204 0 -42 126 -506 541 -1990\n297 -1065 548 -1951 556 -1969 26 -54 77 -82 149 -82 159 0 274 80 274 191 0\n35 -1083 3917 -1105 3959 -21 41 -81 87 -131 99 -54 14 -78 13 -132 -4z"/>\n        <path d="M3845 1352 c-16 -11 -47 -38 -67 -60 -33 -36 -38 -49 -38 -89 l0 -47\n212 -213 212 -213 -212 -213 -212 -213 0 -47 c0 -42 5 -53 42 -93 51 -55 85\n-74 134 -74 36 0 50 12 251 212 l213 212 213 -212 c201 -200 215 -212 251\n-212 49 0 83 19 134 74 37 40 42 51 42 93 l0 47 -212 213 -212 213 212 213\n212 213 0 47 c0 42 -5 53 -42 93 -51 55 -85 74 -134 74 -36 0 -50 -12 -251\n-212 l-213 -212 -213 212 c-205 204 -214 212 -253 212 -21 0 -52 -8 -69 -18z"/>\n    </g>\n</svg>',"unanchor"),this.editButtonView=this._createButton(t("Edit anchor"),'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="m7.3 17.37-.061.088a1.52 1.52 0 0 1-.934.535l-4.178.663-.806-4.153a1.5 1.5 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346zM6.07 16.512l-3.276-2.295.53 2.73zM9.994 3.506 13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328M8 18.5 9.375 17H19v1.5z"/></svg>',"edit"),this.linkButtonView=this._createButton(t("Edit link"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184z"/></svg>',"editanchorlink"),this._focusables=new O.ViewCollection,this._focusCycler=new O.FocusCycler({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-anchor-actions","ck-responsive-form"],tabindex:"-1"},children:[this.editButtonView,this.unanchorButtonView,this.linkButtonView]})}render(){super.render();[this.editButtonView,this.unanchorButtonView,this.linkButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}_createButton(e,t,n){const i=new O.ButtonView(this.locale);return i.set({label:e,icon:t,tooltip:!0}),i.delegate("execute").to(this,n),i}}const Q="anchor-ui";class W extends e.Plugin{static get requires(){return[O.ContextualBalloon,"LinkEditing","LinkUI"]}static get pluginName(){return"AnchorUI"}init(){const e=this.editor;e.editing.view.addObserver(t.ClickObserver),this.actionsView=this._createActionsView(),this.formView=this._createFormView(),this._balloon=e.plugins.get(O.ContextualBalloon),this.linkPlugin=e.plugins.get("LinkUI"),this._createToolbarAnchorButton(),this._enableUserBalloonInteractions(),e.conversion.for("editingDowncast").markerToHighlight({model:Q,view:{classes:["ck-fake-anchor-selection"]}}),e.conversion.for("editingDowncast").markerToElement({model:Q,view:{name:"span",classes:["ck-fake-anchor-selection","ck-fake-anchor-selection_collapsed"]}})}destroy(){super.destroy(),this.formView.destroy()}_createActionsView(){const e=this.editor,t=new K(e.locale),n=e.commands.get("anchor"),i=e.commands.get("unanchor");e.commands.get("link");return t.bind("id").to(n,"value"),t.editButtonView.bind("isEnabled").to(n),t.unanchorButtonView.bind("isEnabled").to(i),this.listenTo(t,"edit",()=>{this._addFormView()}),this.listenTo(t,"unanchor",()=>{e.execute("unanchor"),this._hideUI()}),this.listenTo(t,"editanchorlink",()=>{this.linkPlugin._addActionsView(),this._hideUI()}),t.keystrokes.set("Esc",(e,t)=>{this._hideUI(),t()}),t.keystrokes.set(f,(e,t)=>{this._addFormView(),t()}),t}_createFormView(){const e=this.editor,t=e.commands.get("anchor"),n=e.config.get("anchor.defaultProtocol"),i=new L(e.locale,t);return i.urlInputView.fieldView.bind("value").to(t,"value"),i.urlInputView.bind("isReadOnly").to(t,"isEnabled",e=>!e),i.saveButtonView.bind("isEnabled").to(t),this.listenTo(i,"submit",()=>{const{value:t}=i.urlInputView.fieldView.element,o=p(t,n);e.execute("anchor",o,i.getDecoratorSwitchesState()),this._closeFormView()}),this.listenTo(i,"cancel",()=>{this._closeFormView()}),i.keystrokes.set("Esc",(e,t)=>{this._closeFormView(),t()}),i}_createToolbarAnchorButton(){const e=this.editor,t=e.commands.get("anchor"),n=e.t;e.keystrokes.set(f,(e,n)=>{n(),t.isEnabled&&this._showUI(!0)}),e.ui.componentFactory.add("anchor",e=>{const i=new O.ButtonView(e);return i.isEnabled=!0,i.label=n("Anchor"),i.icon='<svg height="512" viewBox="0 0 58 58" width="512"\n    xmlns="http://www.w3.org/2000/svg">\n    <g id="Page-1" fill="none" fill-rule="evenodd">\n        <g id="037---Waypoint-Flag" fill="rgb(0,0,0)" fill-rule="nonzero" transform="translate(0 -1)">\n            <path id="Shape" d="m14.678 58.9507 1.0678-.2984c1.0270794-.287091 1.6269982-1.3523947 1.34-2.3795l-12.2083-43.6888c-.17227193-.6165569-.58242107-1.139423-1.14021438-1.4535673-.5577933-.3141444-1.21753647-.3938324-1.83408562-.2215327l-.1379.0385c-1.28397381.3587434-2.0340279 1.6904218-1.6753 2.9744l12.2086 43.6888c.2870014 1.0271063 1.3522895 1.6270863 2.3794 1.3401z"/>\n            <path id="Shape" d="m57.67 28.42c-3.8715209-1.930437-7.4530885-4.3944478-10.64-7.32-.2678864-.245221-.3726619-.6216366-.27-.97 1.579074-5.9738125 2.7517572-12.04771023 3.51-18.18.12-1.02-.43-1.32-1.01-.62-11.38 13.61-31.07-2.49-42.79 9.88.14070884.2634479.25140182.5418575.33.83l7.92 28.36c11.74-12.22 31.36 3.78 42.72-9.8.58-.7.69-1.98.23-2.18z"/>\n        </g>\n    </g>\n</svg>',i.keystroke=f,i.tooltip=!0,i.isToggleable=!0,i.bind("isEnabled").to(t,"isEnabled"),i.bind("isOn").to(t,"value",e=>!!e),this.listenTo(i,"execute",()=>this._showUI(!0)),i})}_enableUserBalloonInteractions(){const e=this.editor.editing.view.document;this.listenTo(e,"click",()=>{this._getSelectedAnchorElement()&&this._showUI()}),this.editor.keystrokes.set("Tab",(e,t)=>{this._areActionsVisible&&!this.actionsView.focusTracker.isFocused&&(this.actionsView.focus(),t())},{priority:"high"}),this.editor.keystrokes.set("Esc",(e,t)=>{this._isUIVisible&&(this._hideUI(),t())}),(0,O.clickOutsideHandler)({emitter:this.formView,activator:()=>this._isUIInPanel,contextElements:[this._balloon.view.element],callback:()=>this._hideUI()})}_addActionsView(){this._areActionsInPanel||(this._isSelectedLinkedAnchor()?this.actionsView.linkButtonView.isVisible=!0:this.actionsView.linkButtonView.isVisible=!1,this._balloon.add({view:this.actionsView,position:this._getBalloonPositionData()}))}_addFormView(){if(this._isFormInPanel)return;const e=this.editor.commands.get("anchor");this.formView.disableCssTransitions(),this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this._balloon.visibleView===this.formView&&this.formView.urlInputView.fieldView.select(),this.formView.enableCssTransitions(),this.formView.urlInputView.fieldView.element.value=e.value||""}_closeFormView(){const e=this.editor.commands.get("anchor");e.restoreManualDecoratorStates(),void 0!==e.value?this._removeFormView():this._hideUI()}_removeFormView(){this._isFormInPanel&&(this.formView.saveButtonView.focus(),this._balloon.remove(this.formView),this.editor.editing.view.focus(),this._hideFakeVisualSelection())}_showUI(e=!1){this._getSelectedAnchorElement()?(this._areActionsVisible?this._addFormView():this._addActionsView(),e&&this._balloon.showStack("main")):(this._showFakeVisualSelection(),this._addActionsView(),e&&this._balloon.showStack("main"),this._addFormView()),this._startUpdatingUI()}_hideUI(){if(!this._isUIInPanel)return;const e=this.editor;this.stopListening(e.ui,"update"),this.stopListening(this._balloon,"change:visibleView"),e.editing.view.focus(),this._removeFormView(),this._balloon.remove(this.actionsView),this._hideFakeVisualSelection()}_startUpdatingUI(){const e=this.editor,t=e.editing.view.document;let n=this._getSelectedAnchorElement(),i=r();const o=()=>{const e=this._getSelectedAnchorElement(),t=r();n&&!e||!n&&t!==i?this._hideUI():this._isUIVisible&&this._balloon.updatePosition(this._getBalloonPositionData()),n=e,i=t};function r(){return t.selection.focus.getAncestors().reverse().find(e=>e.is("element"))}this.listenTo(e.ui,"update",o),this.listenTo(this._balloon,"change:visibleView",o)}get _isFormInPanel(){return this._balloon.hasView(this.formView)}get _areActionsInPanel(){return this._balloon.hasView(this.actionsView)}get _areActionsVisible(){return this._balloon.visibleView===this.actionsView}get _isUIInPanel(){return this._isFormInPanel||this._areActionsInPanel}get _isUIVisible(){return this._balloon.visibleView==this.formView||this._areActionsVisible}_getBalloonPositionData(){const e=this.editor.editing.view,t=this.editor.model,n=e.document;let i=null;if(t.markers.has(Q)){const t=Array.from(this.editor.editing.mapper.markerNameToElements(Q)),n=e.createRange(e.createPositionBefore(t[0]),e.createPositionAfter(t[t.length-1]));i=e.domConverter.viewRangeToDom(n)}else{const t=this._getSelectedAnchorElement(),o=n.selection.getFirstRange();i=t?e.domConverter.mapViewToDom(t):e.domConverter.viewRangeToDom(o)}return{target:i}}_getSelectedAnchorElement(){const e=this.editor.editing.view,t=e.document.selection;if(t.isCollapsed)return G(t.getFirstPosition());{const n=t.getFirstRange().getTrimmed(),i=G(n.start),o=G(n.end);return i&&i==o&&e.createRangeIn(i).getTrimmed().isEqual(n)?i:null}}_isSelectedLinkedAnchor(){const e=this.editor.model.document.selection;return e.hasAttribute("anchorId")&&e.hasAttribute("linkHref")}_showFakeVisualSelection(){const e=this.editor.model;e.change(t=>{const n=e.document.selection.getFirstRange();if(e.markers.has(Q))t.updateMarker(Q,{range:n});else if(n.start.isAtEnd){const i=Y(n,e.document.selection.focus,t);t.addMarker(Q,{usingOperation:!1,affectsData:!1,range:i})}else t.addMarker(Q,{usingOperation:!1,affectsData:!1,range:n})})}_hideFakeVisualSelection(){const e=this.editor.model;e.markers.has(Q)&&e.change(e=>{e.removeMarker(Q)})}}function G(e){return e.getAncestors().find(e=>{return(t=e).is("attributeElement")&&!!t.getCustomProperty("anchor")||t.is("attributeElement","a")&&t.hasAttribute("id");var t})}function Y(e,t,n){const i=[e.start.path[0]+1,0],o=n.createPositionFromPath(e.start.root,i,"toNext"),r=n.createRange(o,e.end);return r.start.path[0]>e.end.path[0]?n.createRange(t):o.isAtStart&&o.isAtEnd?Y(r,t,n):r}
+/**
+ * @license Copyright (c) 2003-2020, CKSource - Frederico Knabben. All rights reserved.
+ * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
+ */
+class q extends e.Plugin{static get requires(){return[F,W]}static get pluginName(){return"Anchor"}}})(),(window.CKEditor5=window.CKEditor5||{}).anchorDrupal=i})();
\ No newline at end of file
